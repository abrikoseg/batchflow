

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>UNet &mdash; BatchFlow 0.5.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="VNet" href="batchflow.models.tf.vnet.html" />
    <link rel="prev" title="Xception" href="batchflow.models.tf.xception.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BatchFlow
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">A short introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../intro/classes.html">Classes and capabilities</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro/dsindex.html">Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/dataset.html">Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/batch.html">Batch class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/images_batch.html">Batch class for handling images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/pipeline.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/named_expr.html">Named expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/parallel.html">Within batch parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/prefetch.html">Inter-batch parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/models.html">Working with models</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../intro/tf_models.html">Tensorflow models</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="batchflow.models.tf.models.html">Base Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.models.tf.models.html#classification-networks">Classification networks</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="batchflow.models.tf.models.html#segmentation-networks">Segmentation networks</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">UNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.tf.vnet.html">VNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.tf.densenet_fc.html">DenseNet for segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.tf.refinenet.html">RefineNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.tf.deeplab.html">DeepLab</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.tf.gcn.html">Global Convolution Network</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.tf.fcn.html">FCN</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.tf.linknet.html">LinkNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.tf.faster_rcnn.html">Faster RCNN</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.models.tf.models.html#helpers">Helpers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tf_layers.html">Tensorflow layers and losses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/torch_models.html">Torch models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/research.html">Research</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/model_zoo.html">Model zoo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="batchflow.html">API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BatchFlow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../intro/classes.html">Classes and capabilities</a> &raquo;</li>
        
          <li><a href="../intro/tf_models.html">Tensorflow models</a> &raquo;</li>
        
          <li><a href="batchflow.models.tf.models.html">Base Models</a> &raquo;</li>
        
      <li>UNet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/batchflow.models.tf.unet.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-batchflow.models.tf.unet">
<span id="unet"></span><h1>UNet<a class="headerlink" href="#module-batchflow.models.tf.unet" title="Permalink to this headline">¶</a></h1>
<p>Ronneberger O. et al “<a class="reference external" href="https://arxiv.org/abs/1505.04597">U-Net: Convolutional Networks for Biomedical Image Segmentation</a>”</p>
<p>Zhou Z. et al “UNet++: A Nested U-Net Architecture for Medical Image Segmentation
&lt;<a class="reference external" href="https://arxiv.org/abs/1807.10165">https://arxiv.org/abs/1807.10165</a>&gt;`_”</p>
<dl class="py class">
<dt class="sig sig-object py" id="batchflow.models.tf.unet.UNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">UNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/tf/unet.html#UNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#batchflow.models.tf.unet.UNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="batchflow.models.tf.encoder_decoder.html#batchflow.models.tf.encoder_decoder.EncoderDecoder" title="batchflow.models.tf.encoder_decoder.EncoderDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">batchflow.models.tf.encoder_decoder.EncoderDecoder</span></code></a></p>
<p>UNet-like model</p>
<p><strong>Configuration</strong></p>
<dl>
<dt>inputs<span class="classifier">dict</span></dt><dd><p>dict with ‘images’ and ‘masks’ (see <code class="xref py py-meth docutils literal notranslate"><span class="pre">_make_inputs()</span></code>)</p>
</dd>
<dt>body<span class="classifier">dict</span></dt><dd><dl>
<dt>encoder<span class="classifier">dict</span></dt><dd><dl>
<dt>num_stages<span class="classifier">int</span></dt><dd><p>number of downsampling blocks (default=4)</p>
</dd>
<dt>blocks<span class="classifier">dict</span></dt><dd><p>Parameters for pre-processing blocks:</p>
<dl class="simple">
<dt>filters<span class="classifier">None, int, list of ints or list of lists of ints</span></dt><dd><p>The number of filters in the output tensor.
If int, same number of filters applies to all layers on all stages
If list of ints, specifies number of filters in each layer of different stages
If list of list of ints, specifies number of filters in different layers on different stages
If not given or None, filters parameters in encoder/blocks, decoder/blocks and decoder/upsample
default to values which make number of filters double
on each stage of encoding and halve on each stage of decoding,
provided that <cite>decoder/skip</cite> is <cite>True</cite>. Specify <cite>filters=None</cite> explicitly
if you want to use custom <cite>num_steps</cite> and infer <cite>filters</cite></p>
</dd>
</dl>
</dd>
<dt>n_outputs<span class="classifier">int or list of ints</span></dt><dd><p>the number of supervision outputs from the model or the list of indices of outputs.</p>
</dd>
</dl>
</dd>
<dt>decoder<span class="classifier">dict</span></dt><dd><dl>
<dt>num_stages<span class="classifier">int</span></dt><dd><p>number of upsampling blocks. Defaults to the number of downsamplings.</p>
</dd>
<dt>factor<span class="classifier">None, int or list of ints</span></dt><dd><p>If int, the total upsampling factor for all stages combined.
If list, upsampling factors for each stage
If not given or None, defaults to [2]*num_stages</p>
</dd>
<dt>blocks<span class="classifier">dict</span></dt><dd><p>Parameters for post-processing blocks:</p>
<dl class="simple">
<dt>filters<span class="classifier">None, int, list of ints or list of lists of ints</span></dt><dd><p>same as encoder/blocks/filters</p>
</dd>
</dl>
</dd>
<dt>upsample<span class="classifier">dict</span></dt><dd><p>Parameters for upsampling (see <a class="reference internal" href="batchflow.models.tf.layers.html#batchflow.models.tf.layers.upsample" title="batchflow.models.tf.layers.upsample"><code class="xref py py-func docutils literal notranslate"><span class="pre">upsample()</span></code></a>).</p>
<dl class="simple">
<dt>filters<span class="classifier">int, list of ints or list of lists of ints</span></dt><dd><p>same as encoder/blocks/filters</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>for more parameters see (see <a class="reference internal" href="batchflow.models.tf.encoder_decoder.html#batchflow.models.tf.encoder_decoder.EncoderDecoder" title="batchflow.models.tf.encoder_decoder.EncoderDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncoderDecoder</span></code></a>)</p>
<dl class="py method">
<dt class="sig sig-object py" id="batchflow.models.tf.unet.UNet.default_config">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/tf/unet.html#UNet.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#batchflow.models.tf.unet.UNet.default_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Define model’s defaults: general architecture.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="batchflow.models.tf.unet.UNet.build_config">
<span class="sig-name descname"><span class="pre">build_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/tf/unet.html#UNet.build_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#batchflow.models.tf.unet.UNet.build_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Define model defaults. See :meth: <cite>~.TFModel.default_config</cite></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="batchflow.models.tf.unet.UNetPP">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">UNetPP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/tf/unet.html#UNetPP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#batchflow.models.tf.unet.UNetPP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#batchflow.models.tf.unet.UNet" title="batchflow.models.tf.unet.UNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">batchflow.models.tf.unet.UNet</span></code></a></p>
<p>UNet-like model with dense connections of convilutional layers</p>
<p><strong>Configuration</strong></p>
<dl>
<dt>inputs<span class="classifier">dict</span></dt><dd><p>dict with ‘images’ and ‘masks’ (see <code class="xref py py-meth docutils literal notranslate"><span class="pre">_make_inputs()</span></code>)</p>
</dd>
<dt>body<span class="classifier">dict</span></dt><dd><dl>
<dt>encoder<span class="classifier">dict</span></dt><dd><dl>
<dt>num_stages<span class="classifier">int</span></dt><dd><p>number of downsampling blocks (default=4)</p>
</dd>
<dt>blocks<span class="classifier">dict</span></dt><dd><p>Parameters for pre-processing blocks:</p>
<dl class="simple">
<dt>filters<span class="classifier">None, int, list of ints or list of lists of ints</span></dt><dd><p>The number of filters in the output tensor.
If int, same number of filters applies to all layers on all stages
If list of ints, specifies number of filters in each layer of different stages
If list of list of ints, specifies number of filters in different layers on different stages
If not given or None, filters parameters in encoder/blocks, decoder/blocks and decoder/upsample
default to values which make number of filters double
on each stage of encoding and halve on each stage of decoding,
provided that <cite>decoder/skip</cite> is <cite>True</cite>. Specify <cite>filters=None</cite> explicitly
if you want to use custom <cite>num_steps</cite> and infer <cite>filters</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>decoder<span class="classifier">dict</span></dt><dd><dl>
<dt>num_stages<span class="classifier">int</span></dt><dd><p>number of upsampling blocks. Defaults to the number of downsamplings.</p>
</dd>
<dt>factor<span class="classifier">None, int or list of ints</span></dt><dd><p>If int, the total upsampling factor for all stages combined.
If list, upsampling factors for each stage
If not given or None, defaults to [2]*num_stages</p>
</dd>
<dt>blocks<span class="classifier">dict</span></dt><dd><p>Parameters for post-processing blocks:</p>
<dl class="simple">
<dt>filters<span class="classifier">None, int, list of ints or list of lists of ints</span></dt><dd><p>same as encoder/blocks/filters</p>
</dd>
</dl>
</dd>
<dt>upsample<span class="classifier">dict</span></dt><dd><p>Parameters for upsampling (see <a class="reference internal" href="batchflow.models.tf.layers.html#batchflow.models.tf.layers.upsample" title="batchflow.models.tf.layers.upsample"><code class="xref py py-func docutils literal notranslate"><span class="pre">upsample()</span></code></a>).</p>
<dl class="simple">
<dt>filters<span class="classifier">int, list of ints or list of lists of ints</span></dt><dd><p>same as encoder/blocks/filters</p>
</dd>
</dl>
</dd>
<dt>dense<span class="classifier">dict</span></dt><dd><p>Parameters for dense block on skip connections including parameters for conv_block</p>
<dl class="simple">
<dt>upsample<span class="classifier">dict</span></dt><dd><p>upsample parameters for block</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>for more parameters see (see <a class="reference internal" href="batchflow.models.tf.encoder_decoder.html#batchflow.models.tf.encoder_decoder.EncoderDecoder" title="batchflow.models.tf.encoder_decoder.EncoderDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncoderDecoder</span></code></a>)</p>
<dl class="py method">
<dt class="sig sig-object py" id="batchflow.models.tf.unet.UNetPP.default_config">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/tf/unet.html#UNetPP.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#batchflow.models.tf.unet.UNetPP.default_config" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="batchflow.models.tf.unet.UNetPP.build_config">
<span class="sig-name descname"><span class="pre">build_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/tf/unet.html#UNetPP.build_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#batchflow.models.tf.unet.UNetPP.build_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Define model defaults. See :meth: <cite>~.TFModel.default_config</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="batchflow.models.tf.unet.UNetPP.decoder">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'decoder'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/tf/unet.html#UNetPP.decoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#batchflow.models.tf.unet.UNetPP.decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Create individual decoder for each of the saved skips, with connections between them.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="batchflow.models.tf.unet.UNetPP.head">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'head'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/tf/unet.html#UNetPP.head"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#batchflow.models.tf.unet.UNetPP.head" title="Permalink to this definition">¶</a></dt>
<dd><p>The last network layers which produce predictions. Process all output from body.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list of tf.Tensors</em>) – Input tensors.</p></li>
<li><p><strong>targets</strong> (<em>tf.Tensor</em>) – </p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Scope name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tf.Tensors</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="batchflow.models.tf.vnet.html" class="btn btn-neutral float-right" title="VNet" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="batchflow.models.tf.xception.html" class="btn btn-neutral float-left" title="Xception" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2021, Analysis Center.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>